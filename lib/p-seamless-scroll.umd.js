/*!
* p-seamless-scroll v0.6.4
* Copyright 2024 Pbstar (https://github.com/pbstar)
* Licensed under MIT (https://github.com/pbstar/p-seamless-scroll/blob/main/LICENSE)
* 2024-07-17 11:11:23
*/
!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e="undefined"!=typeof globalThis?globalThis:e||self).pSeamlessScroll=i()}(this,(function(){"use strict";function e(e,i){return"down"==e.config.direction||"up"==e.config.direction?i.offsetHeight:"left"==e.config.direction||"right"==e.config.direction?i.offsetWidth:0}function i(e){var i,n;"up"==e.config.direction||"down"==e.config.direction?null===(i=e.el.firstElementChild)||void 0===i||i.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:0,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||null===(n=e.el.firstElementChild)||void 0===n||n.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:0,fill:"forwards"})}function n(e,n){!function t(){if(e.isPause)return;if("up"==n.config.direction||"left"==n.config.direction)if(Math.abs(n.distance)>=n.contentDistance){if(n.distance=0,i(n),!n.config.loop)return void(e.isPause=!0);t()}else if(n.contentDistance-Math.abs(n.distance)<n.step){var o=(n.contentDistance-Math.abs(n.distance))/n.step*n.config.speed;n.distance=-n.contentDistance,r(o)}else n.distance-=n.step,r(n.config.speed);else if("down"==n.config.direction||"right"==n.config.direction)if(n.distance>=0){if(n.distance=-n.contentDistance,i(n),!n.config.loop)return void(e.isPause=!0);t()}else if(Math.abs(n.distance)<n.step){o=Math.abs(n.distance)/n.step*n.config.speed;n.distance=0,r(o)}else n.distance+=n.step,r(n.config.speed);function r(i){n.config.rest&&(n.restDistance+=n.step*i/n.config.speed,function(e,i,n){i.restDistance>=i.config.rest.distance&&(i.restDistance=0,e.isPause=!0,i.restTimer&&clearTimeout(i.restTimer),i.restTimer=setTimeout((function(){e.isPause=!1,n()}),i.config.rest.time))}(e,n,t)),function(e,i){var n,t;"up"==e.config.direction||"down"==e.config.direction?null===(n=e.el.firstElementChild)||void 0===n||n.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:i,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||null===(t=e.el.firstElementChild)||void 0===t||t.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:i,fill:"forwards"})}(n,i),n.timer&&clearTimeout(n.timer),n.timer=setTimeout((function(){t()}),i)}}()}function t(i,t){if(function(e){if(!e.el)return console.error("ErrCode:101"),!1;if(e.raw_el=e.el.innerHTML,!e.config.directionList.includes(e.config.direction))return console.error("ErrCode:102"),!1;if(e.config.speed<1||e.config.speed>1e5)return console.error("ErrCode:103"),!1;if(e.config.loop&&1!=e.config.loop&&0!=e.config.loop)return console.error("ErrCode:104"),!1;if(e.config.hoverStop&&1!=e.config.hoverStop&&0!=e.config.hoverStop)return console.error("ErrCode:105"),!1;if(e.config.auto&&1!=e.config.auto&&0!=e.config.auto)return console.error("ErrCode:106"),!1;if(e.config.rest){if(!e.config.rest.distance||e.config.rest.distance<10||e.config.rest.distance>1e5||e.config.rest.distance%10!=0)return console.error("ErrCode:107-1"),!1;if(!e.config.rest.time||e.config.rest.time<1||e.config.rest.time>1e5)return console.error("ErrCode:107-2"),!1}return!0}(t)){if(function(e,i){i.timer=null,i.restTimer=null,i.isHoverShield=!1,i.contentDistance=0,i.viewDistance=0,i.step=10,i.distance=0,i.restDistance=0,i.isInit=!1}(0,t),function(e){var i=document.createElement("div");i.style.display="inline-flex","up"!=e.config.direction&&"down"!=e.config.direction||(i.style.flexDirection="column"),i.append(e.el.children),e.el.append(i),i=null}(t),t.contentDistance=e(t,t.el.firstElementChild),t.viewDistance=e(t,t.el),t.contentDistance<t.viewDistance)return console.error("ErrCode:108");if(t.viewDistance<t.step)return console.error("ErrCode:109");!function(i){for(var n,t,o,r,s,c=(null===(n=i.el.firstElementChild)||void 0===n?void 0:n.children.length)||0,f=0,l=0;l<c&&(f+=e(i,null===(t=i.el.firstElementChild)||void 0===t?void 0:t.children[l]),null===(o=i.el.firstElementChild)||void 0===o||o.append(null===(s=null===(r=i.el.firstElementChild)||void 0===r?void 0:r.children[l])||void 0===s?void 0:s.cloneNode(!0)),!(f>=i.viewDistance));l++);}(t),function(e,i,n){i.el.onmouseover=function(){e.isHover||(e.isHover=!0,i.isHoverShield||i.config.hoverStop&&(e.isPause=!0,n()))},i.el.onmouseout=function(){e.isHover&&(e.isHover=!1,i.isHoverShield||i.config.hoverStop&&(e.isPause=!1,n()))}}(i,t,(function(){n(i,t)})),t.isInit=!0,t.config.auto&&n(i,t),function(e,i){e=new Proxy(e,{set:function(e,n,t){e[n]=t,"isPause"==n&&i.restTimer&&clearTimeout(i.restTimer);for(var o=0;o<i.watchs.length;o++){var r=i.watchs[o],s=r.ks,c=r.f;s==n&&c(t)}return!0}})}(i,t)}}function o(e){if(!e.isInit)return console.error("ErrCode:110");e.isInit=!1,e.el.innerHTML=e.raw_el,e.timer&&clearTimeout(e.timer),e.restTimer&&clearTimeout(e.restTimer),e.config.hoverStop&&e.el.onmouseover&&(e.el.onmouseover=null,e.el.onmouseout=null)}return function(e){var i=this,r={el:e.el,raw_el:null,config:{direction:e.direction||"up",directionList:["up","down","left","right"],hoverStop:!1!==e.hoverStop,speed:e.speed||100,auto:!1!==e.auto,loop:!1!==e.loop,rest:e.rest||null},timer:null,restTimer:null,isHoverShield:!1,contentDistance:0,viewDistance:0,step:10,distance:0,restDistance:0,isInit:!1,watchs:[]};this.state={isHover:!1,isPause:!1},this.play=function(){!function(e,i){if(!i.isInit)return console.error("ErrCode:110");e.isPause=!1,i.isHoverShield=!1,n(e,i)}(i.state,r)},this.pause=function(){!function(e,i){if(!i.isInit)return console.error("ErrCode:110");e.isPause=!0,i.isHoverShield=!0}(i.state,r)},this.reload=function(e){o(r),r.config.direction=e.direction||"up",r.config.hoverStop=!1!==e.hoverStop,r.config.speed=e.speed||100,r.config.auto=!1!==e.auto,r.config.loop=!1!==e.loop,r.config.rest=e.rest||null,t(i.state,r)},this.destroy=function(){o(r)},this.getState=function(){return i.state},this.on=function(e,i){"hover"==e?r.watchs.push({es:e,ks:"isHover",f:i}):"pause"==e&&r.watchs.push({es:e,ks:"isPause",f:i})},this.off=function(e){var i=r.watchs.filter((function(i){return i.es!==e}));r.watchs=i},t(this.state,r)}}));
