/*!
* p-seamless-scroll v0.6.4
* Copyright 2024 Pbstar (https://github.com/pbstar)
* Licensed under MIT (https://github.com/pbstar/p-seamless-scroll/blob/main/LICENSE)
* 2024-07-18 15:24:42
*/
function e(e,i){return"down"==e.config.direction||"up"==e.config.direction?i.offsetHeight:"left"==e.config.direction||"right"==e.config.direction?i.offsetWidth:0}function i(e){var i,t;"up"==e.config.direction||"down"==e.config.direction?null===(i=e.el.firstElementChild)||void 0===i||i.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:0,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||null===(t=e.el.firstElementChild)||void 0===t||t.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:0,fill:"forwards"})}function t(e){!function t(){if(e.state.isPause)return;if("up"==e.config.direction||"left"==e.config.direction)if(Math.abs(e.distance)>=e.contentDistance){if(e.distance=0,i(e),!e.config.loop)return void(e.state.isPause=!0);t()}else if(e.contentDistance-Math.abs(e.distance)<e.step){var n=(e.contentDistance-Math.abs(e.distance))/e.step*e.config.speed;e.distance=-e.contentDistance,o(n)}else e.distance-=e.step,o(e.config.speed);else if("down"==e.config.direction||"right"==e.config.direction)if(e.distance>=0){if(e.distance=-e.contentDistance,i(e),!e.config.loop)return void(e.state.isPause=!0);t()}else if(Math.abs(e.distance)<e.step){n=Math.abs(e.distance)/e.step*e.config.speed;e.distance=0,o(n)}else e.distance+=e.step,o(e.config.speed);function o(i){e.config.rest&&(e.restDistance+=e.step*i/e.config.speed,function(e,i){e.restDistance>=e.config.rest.distance&&(e.restDistance=0,e.state.isPause=!0,e.restTimer&&clearTimeout(e.restTimer),e.restTimer=setTimeout((function(){e.state.isPause=!1,i()}),e.config.rest.time))}(e,t)),function(e,i){var t,n;"up"==e.config.direction||"down"==e.config.direction?null===(t=e.el.firstElementChild)||void 0===t||t.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:i,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||null===(n=e.el.firstElementChild)||void 0===n||n.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:i,fill:"forwards"})}(e,i),e.timer&&clearTimeout(e.timer),e.timer=setTimeout((function(){t()}),i)}}()}function n(i){if(function(e){if(!e.el)return console.error("ErrCode:101"),!1;if(e.raw_el=e.el.innerHTML,!e.config.directionList.includes(e.config.direction))return console.error("ErrCode:102"),!1;if(e.config.speed<1||e.config.speed>1e5)return console.error("ErrCode:103"),!1;if(e.config.loop&&1!=e.config.loop&&0!=e.config.loop)return console.error("ErrCode:104"),!1;if(e.config.hoverStop&&1!=e.config.hoverStop&&0!=e.config.hoverStop)return console.error("ErrCode:105"),!1;if(e.config.auto&&1!=e.config.auto&&0!=e.config.auto)return console.error("ErrCode:106"),!1;if(e.config.rest){if(!e.config.rest.distance||e.config.rest.distance<10||e.config.rest.distance>1e5||e.config.rest.distance%10!=0)return console.error("ErrCode:107-1"),!1;if(!e.config.rest.time||e.config.rest.time<1||e.config.rest.time>1e5)return console.error("ErrCode:107-2"),!1}return!0}(i)){if(function(e){e.state={isHover:!1,isPause:!1},e.timer=null,e.restTimer=null,e.isHoverShield=!1,e.contentDistance=0,e.viewDistance=0,e.step=10,e.distance=0,e.restDistance=0,e.isInit=!1}(i),function(e){var i=document.createElement("div");i.style.display="inline-flex","up"!=e.config.direction&&"down"!=e.config.direction||(i.style.flexDirection="column"),i.append(e.el.children),e.el.append(i),i=null}(i),i.contentDistance=e(i,i.el.firstElementChild),i.viewDistance=e(i,i.el),i.contentDistance<i.viewDistance)return console.error("ErrCode:108");if(i.viewDistance<i.step)return console.error("ErrCode:109");!function(i){for(var t,n,o,r,s,c=(null===(t=i.el.firstElementChild)||void 0===t?void 0:t.children.length)||0,a=0,l=0;l<c&&(a+=e(i,null===(n=i.el.firstElementChild)||void 0===n?void 0:n.children[l]),null===(o=i.el.firstElementChild)||void 0===o||o.append(null===(s=null===(r=i.el.firstElementChild)||void 0===r?void 0:r.children[l])||void 0===s?void 0:s.cloneNode(!0)),!(a>=i.viewDistance));l++);}(i),function(e,i){e.el.onmouseover=function(){e.state.isHover||(e.state.isHover=!0,e.isHoverShield||e.config.hoverStop&&(e.state.isPause=!0,i()))},e.el.onmouseout=function(){e.state.isHover&&(e.state.isHover=!1,e.isHoverShield||e.config.hoverStop&&(e.state.isPause=!1,i()))}}(i,(function(){t(i)})),i.isInit=!0,i.config.auto&&t(i)}}function o(e){if(!e.isInit)return console.error("ErrCode:110");e.isInit=!1,e.el.innerHTML=e.raw_el,e.timer&&clearTimeout(e.timer),e.restTimer&&clearTimeout(e.restTimer),e.config.hoverStop&&e.el.onmouseover&&(e.el.onmouseover=null,e.el.onmouseout=null)}var r=function(e){var i={el:e.el,raw_el:null,config:{direction:e.direction||"up",directionList:["up","down","left","right"],hoverStop:!1!==e.hoverStop,speed:e.speed||100,auto:!1!==e.auto,loop:!1!==e.loop,rest:e.rest||null},state:{isHover:!1,isPause:!1},timer:null,restTimer:null,isHoverShield:!1,contentDistance:0,viewDistance:0,step:10,distance:0,restDistance:0,isInit:!1,watchs:[]};this.state={isHover:!1,isPause:!1},this.play=function(){!function(e){if(!e.isInit)return console.error("ErrCode:110");e.state.isPause=!1,e.isHoverShield=!1,t(e)}(i)},this.pause=function(){!function(e){if(!e.isInit)return console.error("ErrCode:110");e.state.isPause=!0,e.isHoverShield=!0}(i)},this.reload=function(e){o(i),i.config.direction=e.direction||"up",i.config.hoverStop=!1!==e.hoverStop,i.config.speed=e.speed||100,i.config.auto=!1!==e.auto,i.config.loop=!1!==e.loop,i.config.rest=e.rest||null,n(i)},this.destroy=function(){o(i)},this.getState=function(){return i.state},this.on=function(e,t){"hover"==e?i.watchs.push({es:e,ks:"isHover",f:t}):"pause"==e&&i.watchs.push({es:e,ks:"isPause",f:t})},this.off=function(e){var t=i.watchs.filter((function(i){return i.es!==e}));i.watchs=t},n(i);var r=this;i.state=new Proxy(i.state,{set:function(e,t,n,o){r.state[t]=n,"isPause"==t&&i.restTimer&&clearTimeout(i.restTimer);for(var s=0;s<i.watchs.length;s++){var c=i.watchs[s],a=c.ks,l=c.f;a==t&&l(n)}return console.log("set",t,n),Reflect.set(e,t,n,o)}})};export{r as default};
