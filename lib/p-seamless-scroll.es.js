/*!
* p-seamless-scroll v0.7.0
* Copyright 2024 Pbstar (https://github.com/pbstar)
* Licensed under MIT (https://github.com/pbstar/p-seamless-scroll/blob/main/LICENSE)
* 2024-07-19 15:30:58
*/
function e(e,i){return"down"==e.config.direction||"up"==e.config.direction?i.offsetHeight:"left"==e.config.direction||"right"==e.config.direction?i.offsetWidth:0}function i(e){var i,t,n,o;"up"==e.config.direction||"down"==e.config.direction?null===(t=null===(i=e.el.firstElementChild)||void 0===i?void 0:i.firstElementChild)||void 0===t||t.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:0,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||null===(o=null===(n=e.el.firstElementChild)||void 0===n?void 0:n.firstElementChild)||void 0===o||o.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:0,fill:"forwards"})}function t(e){!function t(){if(e.state.isPause)return;if("up"==e.config.direction||"left"==e.config.direction)if(Math.abs(e.distance)>=e.contentDistance){if(e.distance=0,i(e),!e.config.loop)return void(e.state.isPause=!0);t()}else if(e.contentDistance-Math.abs(e.distance)<e.step){var n=(e.contentDistance-Math.abs(e.distance))/e.step*e.config.speed;e.distance=-e.contentDistance,o(n)}else e.distance-=e.step,o(e.config.speed);else if("down"==e.config.direction||"right"==e.config.direction)if(e.distance>=0){if(e.distance=-e.contentDistance,i(e),!e.config.loop)return void(e.state.isPause=!0);t()}else if(Math.abs(e.distance)<e.step){n=Math.abs(e.distance)/e.step*e.config.speed;e.distance=0,o(n)}else e.distance+=e.step,o(e.config.speed);function o(i){e.config.rest&&(e.restDistance+=e.step*i/e.config.speed,function(e,i){e.restDistance>=e.config.rest.distance&&(e.restDistance=0,e.state.isPause=!0,e.restTimer&&clearTimeout(e.restTimer),e.restTimer=setTimeout((function(){e.state.isPause=!1,i()}),e.config.rest.time))}(e,t)),function(e,i){var t,n,o,r;"up"==e.config.direction||"down"==e.config.direction?null===(n=null===(t=e.el.firstElementChild)||void 0===t?void 0:t.firstElementChild)||void 0===n||n.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:i,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||null===(r=null===(o=e.el.firstElementChild)||void 0===o?void 0:o.firstElementChild)||void 0===r||r.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:i,fill:"forwards"})}(e,i),e.timer&&clearTimeout(e.timer),e.timer=setTimeout((function(){t()}),i)}}()}function n(i,n){if(function(e){if(!e.el)return console.error("ErrCode:101"),!1;if(e.raw_el=e.el.innerHTML,!e.config.directionList.includes(e.config.direction))return console.error("ErrCode:102"),!1;if(e.config.speed<1||e.config.speed>1e5)return console.error("ErrCode:103"),!1;if(e.config.loop&&1!=e.config.loop&&0!=e.config.loop)return console.error("ErrCode:104"),!1;if(e.config.hoverStop&&1!=e.config.hoverStop&&0!=e.config.hoverStop)return console.error("ErrCode:105"),!1;if(e.config.auto&&1!=e.config.auto&&0!=e.config.auto)return console.error("ErrCode:106"),!1;if(e.config.rest){if(!e.config.rest.distance||e.config.rest.distance<10||e.config.rest.distance>1e5||e.config.rest.distance%10!=0)return console.error("ErrCode:107-1"),!1;if(!e.config.rest.time||e.config.rest.time<1||e.config.rest.time>1e5)return console.error("ErrCode:107-2"),!1}return!0}(i)){if(function(e){e.state={isHover:!1,isPause:!1},e.timer=null,e.restTimer=null,e.isHoverShield=!1,e.contentDistance=0,e.viewDistance=0,e.step=10,e.distance=0,e.restDistance=0,e.isInit=!1}(i),function(e){var i=document.createElement("div"),t=document.createElement("div");i.style.display="inline-flex",i.style.pointerEvents="none",t.style.width="100%",t.style.height="100%",t.style.overflow="hidden","up"!=e.config.direction&&"down"!=e.config.direction||(i.style.flexDirection="column");for(var n=0;n<e.el.children.length;n++)i.append(e.el.children[n]);t.append(i),e.el.append(t),t=null,i=null}(i),i.contentDistance=e(i,i.el.firstElementChild.firstElementChild),i.viewDistance=e(i,i.el),i.contentDistance<i.viewDistance)return console.error("ErrCode:108");if(i.viewDistance<i.step)return console.error("ErrCode:109");!function(i){for(var t,n,o,r,s,l,c,f,d,a=(null===(n=null===(t=i.el.firstElementChild)||void 0===t?void 0:t.firstElementChild)||void 0===n?void 0:n.children.length)||0,u=0,p=0;p<a&&(u+=e(i,null===(r=null===(o=i.el.firstElementChild)||void 0===o?void 0:o.firstElementChild)||void 0===r?void 0:r.children[p]),null===(l=null===(s=i.el.firstElementChild)||void 0===s?void 0:s.firstElementChild)||void 0===l||l.append(null===(d=null===(f=null===(c=i.el.firstElementChild)||void 0===c?void 0:c.firstElementChild)||void 0===f?void 0:f.children[p])||void 0===d?void 0:d.cloneNode(!0)),!(u>=i.viewDistance));p++);}(i),function(e,i){e.el.firstElementChild.onmouseenter=function(){e.state.isHover||(e.state.isHover=!0,e.isHoverShield||e.config.hoverStop&&(e.state.isPause=!0,i()))},e.el.firstElementChild.onmouseleave=function(){e.state.isHover&&(e.state.isHover=!1,e.isHoverShield||e.config.hoverStop&&(e.state.isPause=!1,i()))}}(i,(function(){t(i)})),i.isInit=!0,i.config.auto&&t(i),function(e,i){e.state=new Proxy(e.state,{set:function(t,n,o,r){i.state[n]=o,"isPause"==n&&e.restTimer&&clearTimeout(e.restTimer);for(var s=0;s<e.watchs.length;s++){var l=e.watchs[s],c=l.ks,f=l.f;c==n&&f(o)}return Reflect.set(t,n,o,r)}})}(i,n)}}function o(e){var i;if(!e.isInit)return console.error("ErrCode:110");e.isInit=!1,e.el.innerHTML=e.raw_el,e.timer&&clearTimeout(e.timer),e.restTimer&&clearTimeout(e.restTimer),e.config.hoverStop&&(null===(i=e.el.firstElementChild)||void 0===i?void 0:i.onmouseenter)&&(e.el.firstElementChild.onmouseenter=null,e.el.firstElementChild.mouseleave=null),e.state=new Proxy(e.state,{})}var r={el:null,raw_el:null,config:{direction:"up",directionList:["up","down","left","right"],hoverStop:!1,speed:100,auto:!0,loop:!0,rest:null},state:{isHover:!1,isPause:!1},timer:null,restTimer:null,isHoverShield:!1,contentDistance:0,viewDistance:0,step:10,distance:0,restDistance:0,isInit:!1,watchs:[]},s=function(){function e(e){this.state={isHover:!1,isPause:!1},this.init(e)}return e.prototype.init=function(e){r.el=e.el,r.config.direction=e.direction||"up",r.config.hoverStop=!0===e.hoverStop,r.config.speed=e.speed||100,r.config.auto=!1!==e.auto,r.config.loop=!1!==e.loop,r.config.rest=e.rest||null,n(r,this)},e.prototype.play=function(){!function(e){if(!e.isInit)return console.error("ErrCode:110");e.state.isPause=!1,e.isHoverShield=!1,t(e)}(r)},e.prototype.pause=function(){!function(e){if(!e.isInit)return console.error("ErrCode:110");e.state.isPause=!0,e.isHoverShield=!0}(r)},e.prototype.reload=function(e){o(r),r.config.direction=e.direction||"up",r.config.hoverStop=!0===e.hoverStop,r.config.speed=e.speed||100,r.config.auto=!1!==e.auto,r.config.loop=!1!==e.loop,r.config.rest=e.rest||null,n(r,this)},e.prototype.destroy=function(){o(r)},e.prototype.getState=function(){return r.state},e.prototype.on=function(e,i){"hover"==e?r.watchs.push({es:e,ks:"isHover",f:i}):"pause"==e&&r.watchs.push({es:e,ks:"isPause",f:i})},e.prototype.off=function(e){var i=r.watchs.filter((function(i){return i.es!==e}));r.watchs=i},e}();export{s as default};
