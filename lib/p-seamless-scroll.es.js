function e(e,t){return"down"==e.config.direction||"up"==e.config.direction?t.offsetHeight:"left"==e.config.direction||"right"==e.config.direction?t.offsetWidth:0}function t(e){"up"==e.config.direction||"down"==e.config.direction?e.el.firstElementChild.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:0,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||e.el.firstElementChild.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:0,fill:"forwards"})}function i(e,i){!function n(){if(e.state.isPause)return;if("up"==i.config.direction||"left"==i.config.direction)if(Math.abs(i.distance)>=i.contentDistance){if(i.distance=0,t(i),!i.config.loop)return e.state.isPause=!0,void(i.onPause&&i.onPause(e.state.isPause));n()}else if(i.contentDistance-Math.abs(i.distance)<i.step){let e=(i.contentDistance-Math.abs(i.distance))/i.step*i.config.speed;i.distance=-i.contentDistance,o(e)}else i.distance-=i.step,o(i.config.speed);else if("down"==i.config.direction||"right"==i.config.direction)if(i.distance>=0){if(i.distance=-i.contentDistance,t(i),!i.config.loop)return e.state.isPause=!0,void(i.onPause&&i.onPause(e.state.isPause));n()}else if(Math.abs(i.distance)<i.step){let e=Math.abs(i.distance)/i.step*i.config.speed;i.distance=0,o(e)}else i.distance+=i.step,o(i.config.speed);function o(t){i.config.rest&&(i.restDistance+=i.step*t/i.config.speed,function(e,t,i){t.restDistance>=t.config.rest.distance&&(t.restDistance=0,e.state.isPause=!0,t.onPause&&t.onPause(e.state.isPause),t.restTimer&&clearTimeout(t.restTimer),t.restTimer=setTimeout((()=>{e.state.isPause=!1,t.onPause&&t.onPause(e.state.isPause),i()}),t.config.rest.time))}(e,i,n)),function(e,t){"up"==e.config.direction||"down"==e.config.direction?e.el.firstElementChild.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:t,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||e.el.firstElementChild.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:t,fill:"forwards"})}(i,t),i.timer&&clearTimeout(i.timer),i.timer=setTimeout((()=>{n()}),t)}}()}function n(t,n){if(function(e){if(!e.el||!e.el instanceof HTMLElement)return console.error("ErrCode:101"),!1;if(e.raw_el=e.el.innerHTML,!e.config.directionList.includes(e.config.direction))return console.error("ErrCode:102"),!1;if(e.config.speed<1||e.config.speed>1e5)return console.error("ErrCode:103"),!1;if(e.config.loop&&1!=e.config.loop&&0!=e.config.loop)return console.error("ErrCode:104"),!1;if(e.config.hoverStop&&1!=e.config.hoverStop&&0!=e.config.hoverStop)return console.error("ErrCode:105"),!1;if(e.config.auto&&1!=e.config.auto&&0!=e.config.auto)return console.error("ErrCode:106"),!1;if(e.config.rest){if(!e.config.rest.distance||e.config.rest.distance<1||e.config.rest.distance>1e5)return console.error("ErrCode:107-1"),!1;if(!e.config.rest.time||e.config.rest.time<1||e.config.rest.time>1e5)return console.error("ErrCode:107-2"),!1}return!0}(n)){if(function(e,t){e.state={isHover:!1,isPause:!1},t.timer=null,t.restTimer=null,t.isHoverShield=!1,t.contentDistance=0,t.viewDistance=0,t.step=0,t.distance=0,t.onHover=null,t.onPause=null,t.restDistance=0}(t,n),function(e){let t=document.createElement("div");t.style.display="inline-flex","up"!=e.config.direction&&"down"!=e.config.direction||(t.style.flexDirection="column"),t.append(...e.el.children),e.el.append(t),t=null}(n),n.contentDistance=e(n,n.el.firstElementChild),n.viewDistance=e(n,n.el),n.contentDistance<n.viewDistance)return console.warn("ErrCode:108");if(n.viewDistance<10)return console.warn("ErrCode:109");!function(e){e.viewDistance>600?e.step=30:e.viewDistance>200?e.step=20:e.viewDistance>50?e.step=10:e.step=5}(n),function(t){let i=t.el.firstElementChild.children.length,n=0;for(let o=0;o<i&&(n+=e(t,t.el.firstElementChild.children[o]),t.el.firstElementChild.append(t.el.firstElementChild.children[o].cloneNode(!0)),!(n>=t.viewDistance));o++);}(n),n.config.hoverStop&&function(e,t,i){function n(e,t){let i;return function(){const n=this,o=arguments;clearTimeout(i),i=setTimeout((function(){e.apply(n,o)}),t)}}t.el.onmouseover=n((()=>{e.state.isHover||(e.state.isHover=!0,t.isHoverShield||(e.state.isPause=!0,i()))}),100),t.el.onmouseout=n((()=>{e.state.isHover&&(e.state.isHover=!1,t.isHoverShield||(e.state.isPause=!1,i()))}),100)}(t,n,(()=>{i(t,n),n.onHover&&n.onHover(t.state.isHover),n.onPause&&n.onPause(t.state.isPause)})),n.config.auto&&i(t,n)}}function o(e){e.el.innerHTML=e.raw_el,e.timer&&clearTimeout(e.timer),e.restTimer&&clearTimeout(e.restTimer),e.config.hoverStop&&e.el.onmouseover&&(e.el.onmouseover=null,e.el.onmouseout=null)}class s{constructor(e){let t={el:e.el,raw_el:null,config:{direction:e.direction||"up",directionList:["up","down","left","right"],hoverStop:!1!==e.hoverStop,speed:e.speed||100,auto:!1!==e.auto,loop:!1!==e.loop,rest:e.rest||null},timer:null,restTimer:null,isHoverShield:!1,contentDistance:0,viewDistance:0,step:0,distance:0,restDistance:0,onHover:null,onPause:null};this.state={isHover:!1,isPause:!1},this.play=()=>{var e,n;n=t,(e=this).state.isPause=!1,n.onPause&&n.onPause(e.state.isPause),n.isHoverShield=!1,i(e,n)},this.pause=()=>{var e,i;i=t,(e=this).state.isPause=!0,i.onPause&&i.onPause(e.state.isPause),i.isHoverShield=!0},this.reload=e=>{if(o(t),e)for(let i in e)"el"!=i&&(t.config[i]=e[i]);n(this,t)},this.destroy=()=>{o(this)},this.getState=()=>this.state,this.on=(e,i)=>{"hover"===e&&(t.onHover=i),"pause"===e&&(t.onPause=i)},this.off=e=>{"hover"===e&&(t.onHover=null),"pause"===e&&(t.onPause=null)},n(this,t)}}export{s as default};
