function e(e,t){return"down"==e.config.direction||"up"==e.config.direction?t.offsetHeight:"left"==e.config.direction||"right"==e.config.direction?t.offsetWidth:0}function t(e){"up"==e.config.direction||"down"==e.config.direction?e.el.firstElementChild.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:0,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||e.el.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:0,fill:"forwards"})}function i(e,t){"up"==e.config.direction||"down"==e.config.direction?e.el.firstElementChild.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:t,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||e.el.firstElementChild.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:t,fill:"forwards"})}function n(e,n){function o(){if(!e.state.isPause){if(n.config.rest){let t=n.distance;n.distance<0&&(t=n.distance+n.contentDistance),Math.abs(t%n.config.rest.distance)<n.step&&t>=n.step&&(e.state.isPause=!0,n.onPause&&n.onPause(e.state.isPause),setTimeout((()=>{e.state.isPause=!1,n.onPause&&n.onPause(e.state.isPause)}),n.config.rest.time))}"up"==n.config.direction||"left"==n.config.direction?Math.abs(n.distance)>=n.contentDistance?(n.distance=0,t(n),n.config.loop?o():(clearInterval(n.timer),n.timer=null,n.isStarted=!1,e.state.isPause=!0,n.onPause&&n.onPause(e.state.isPause))):(n.distance-=n.step,i(n,n.config.speed)):"down"!=n.config.direction&&"right"!=n.config.direction||(n.distance>=0&&n.config.loop?(n.distance=-n.contentDistance,t(n),n.config.loop?o():(clearInterval(n.timer),n.timer=null,n.isStarted=!1,e.state.isPause=!0,n.onPause&&n.onPause(e.state.isPause))):(n.distance+=n.step,i(n,n.config.speed)))}}n.timer&&clearInterval(n.timer),n.timer=setInterval((()=>{o()}),n.config.speed)}function o(e,n){!function o(){if(e.state.isPause)return;if(n.config.rest){let t=n.distance;n.distance<0&&(t=n.distance+n.contentDistance),Math.abs(t%n.config.rest.distance)<n.step&&t+n.step<n.contentDistance&&0!=t&&(e.state.isPause=!0,n.onPause&&n.onPause(e.state.isPause),setTimeout((()=>{e.state.isPause=!1,o(),n.onPause&&n.onPause(e.state.isPause)}),n.config.rest.time))}if("up"==n.config.direction||"left"==n.config.direction)if(Math.abs(n.distance)>=n.contentDistance){if(n.distance=0,t(n),!n.config.loop)return e.state.isPause=!0,void(n.onPause&&n.onPause(e.state.isPause));o()}else if(n.contentDistance-Math.abs(n.distance)<n.step){let e=(n.contentDistance-Math.abs(n.distance))/n.step*n.config.speed;n.distance=-n.contentDistance,s(e)}else n.distance-=n.step,s(n.config.speed);else if("down"==n.config.direction||"right"==n.config.direction)if(n.distance>=0){if(n.distance=-n.contentDistance,t(n),!n.config.loop)return e.state.isPause=!0,void(n.onPause&&n.onPause(e.state.isPause));o()}else if(Math.abs(n.distance)<n.step){let e=Math.abs(n.distance)/n.step*n.config.speed;n.distance=0,s(e)}else n.distance+=n.step,s(n.config.speed);function s(e){i(n,e),n.timer&&clearTimeout(n.timer),n.timer=setTimeout((()=>{o()}),e)}}()}function s(i,s){if(!function(e){if(!e.el||!e.el instanceof HTMLElement)return console.error('请挂载正确的el元素！例如：document.getElementById("id")'),!1;if(!e.config.modeList.includes(e.config.mode))return console.error("请配置正确的mode滚动方向！例如："+e.config.modeList.join("、")),!1;if(!e.config.directionList.includes(e.config.direction))return console.error("请配置正确的direction滚动方向！例如："+e.config.directionList.join("、")),!1;if(e.config.speed<1||e.config.speed>1e5)return console.error("请配置正确的speed滚动速度！例如：1-100000"),!1;if(e.config.loop&&1!=e.config.loop&&0!=e.config.loop)return console.error("请配置正确的loop是否循环滚动！例如：true、false"),!1;if(e.config.hoverStop&&1!=e.config.hoverStop&&0!=e.config.hoverStop)return console.error("请配置正确的hoverStop是否鼠标移入停止！例如：true、false"),!1;if(e.config.auto&&1!=e.config.auto&&0!=e.config.auto)return console.error("请配置正确的auto是否自动滚动！例如：true、false"),!1;if(e.config.rest){if(!e.config.rest.distance||e.config.rest.distance<1||e.config.rest.distance>1e5)return console.error("请配置正确的rest.distance停留前滚动距离！例如：1-100000"),!1;if(!e.config.rest.time||e.config.rest.time<1||e.config.rest.time>1e5)return console.error("请配置正确的rest.time停留时间！例如：1-100000"),!1}return!0}(s))return;const a=document.createElement("div");if(a.append(...s.el.children),s.el.append(a),s.contentDistance=e(s,s.el.firstElementChild),s.viewDistance=e(s,s.el),s.contentDistance<s.viewDistance)return console.warn("滚动元素长度小于滚动视口长度，无需开启滚动！");s.viewDistance>600?s.step=10:s.viewDistance>200?s.step=5:s.step=2,"distance"==s.config.mode&&function(e){let t=e.contentDistance%e.step;if(0!=t){let i=e.step-t;e.contentDistance=e.contentDistance+i;let n=document.createElement("div");n.style.width=i+"px",n.style.height=i+"px",e.el.firstElementChild.append(n)}}(s),"down"!=s.config.direction&&"right"!=s.config.direction||(s.distance=-s.contentDistance,t(s)),function(t){let i=t.el.firstElementChild.children.length,n=0;for(let o=0;o<i&&(n+=e(t,t.el.firstElementChild.children[o]),t.el.firstElementChild.append(t.el.firstElementChild.children[o].cloneNode(!0)),!(n>=t.viewDistance));o++);}(s),s.config.hoverStop&&function(e,t,i){function n(e,t){let i;return function(){const n=this,o=arguments;clearTimeout(i),i=setTimeout((function(){e.apply(n,o)}),t)}}t.el.onmouseover=n((()=>{e.state.isHover||(e.state.isHover=!0,t.isHoverShield||(e.state.isPause=!0,i()))}),100),t.el.onmouseout=n((()=>{e.state.isHover&&(e.state.isHover=!1,t.isHoverShield||(e.state.isPause=!1,i()))}),100)}(i,s,(()=>{"time"==s.config.mode&&o(i,s),s.onHover&&s.onHover(i.state.isHover),s.onPause&&s.onPause(i.state.isPause)})),s.config.auto&&(s.isStarted=!0,"distance"==s.config.mode?n(i,s):"time"==s.config.mode&&o(i,s))}class a{constructor(e){let t={el:e.el,config:{mode:e.mode||"distance",modeList:["distance","time"],direction:e.direction||"up",directionList:["up","down","left","right"],hoverStop:!1!==e.hoverStop,speed:e.speed||100,auto:!1!==e.auto,loop:!1!==e.loop,rest:e.rest||null},timer:null,isHoverShield:!1,isStarted:!1,contentDistance:0,viewDistance:0,step:0,distance:0,onHover:null,onPause:null};this.state={isHover:!1,isPause:!1},this.play=()=>{var e,i;i=t,(e=this).state.isPause=!1,i.onPause&&i.onPause(e.state.isPause),i.isHoverShield=!1,"distance"==i.config.mode?i.isStarted||(i.isStarted=!0,n(e,i)):"time"==i.config.mode&&o(e,i)},this.pause=()=>{var e,i;i=t,(e=this).state.isPause=!0,i.onPause&&i.onPause(e.state.isPause),i.isHoverShield=!0},this.reload=e=>{if(e)for(let t in e)this.config[t]=e[t];s(this,t)},this.destroy=()=>{var e;(e=t).timer&&clearInterval(e.timer),e.config.hoverStop&&(e.el.onmouseover.remove(),e.el.onmouseout.remove()),e=null},this.getState=()=>this.state,this.on=(e,i)=>{"hover"===e&&(t.onHover=i),"pause"===e&&(t.onPause=i)},this.off=e=>{"hover"===e&&(t.onHover=null),"pause"===e&&(t.onPause=null)},s(this,t)}}export{a as default};
