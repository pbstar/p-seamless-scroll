function e(e,t){return"down"==e.config.direction||"up"==e.config.direction?t.offsetHeight:"left"==e.config.direction||"right"==e.config.direction?t.offsetWidth:0}function t(e){"up"==e.config.direction||"down"==e.config.direction?e.el.firstElementChild.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:0,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||e.el.firstElementChild.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:0,fill:"forwards"})}function i(e,t){"up"==e.config.direction||"down"==e.config.direction?e.el.firstElementChild.animate({transform:"translate(0px, "+e.distance+"px)"},{duration:t,fill:"forwards"}):"left"!=e.config.direction&&"right"!=e.config.direction||e.el.firstElementChild.animate({transform:"translate("+e.distance+"px, 0px)"},{duration:t,fill:"forwards"})}function n(e,t,i){let n=0;n="up"==t.config.direction||"left"==t.config.direction?Math.abs(t.distance):t.contentDistance+t.distance,Math.abs(n%t.config.rest.distance)<t.step&&n+t.step<t.contentDistance&&0!=n&&(e.state.isPause=!0,t.onPause&&t.onPause(e.state.isPause),setTimeout((()=>{e.state.isPause=!1,t.onPause&&t.onPause(e.state.isPause),"time"==t.config.mode&&i()}),t.config.rest.time))}function o(e,o){function s(){e.state.isPause||(o.config.rest&&n(e,o,(()=>{})),"up"==o.config.direction||"left"==o.config.direction?Math.abs(o.distance)>=o.contentDistance?(o.distance=0,t(o),o.config.loop?s():(clearInterval(o.timer),o.timer=null,o.isStarted=!1,e.state.isPause=!0,o.onPause&&o.onPause(e.state.isPause))):(o.distance-=o.step,i(o,o.config.speed)):"down"!=o.config.direction&&"right"!=o.config.direction||(o.distance>=0&&o.config.loop?(o.distance=-o.contentDistance,t(o),o.config.loop?s():(clearInterval(o.timer),o.timer=null,o.isStarted=!1,e.state.isPause=!0,o.onPause&&o.onPause(e.state.isPause))):(o.distance+=o.step,i(o,o.config.speed))))}o.timer&&clearInterval(o.timer),o.timer=setInterval((()=>{s()}),o.config.speed)}function s(e,o){!function s(){if(e.state.isPause)return;o.config.rest&&n(e,o,s);if("up"==o.config.direction||"left"==o.config.direction)if(Math.abs(o.distance)>=o.contentDistance){if(o.distance=0,t(o),!o.config.loop)return e.state.isPause=!0,void(o.onPause&&o.onPause(e.state.isPause));s()}else if(o.contentDistance-Math.abs(o.distance)<o.step){let e=(o.contentDistance-Math.abs(o.distance))/o.step*o.config.speed;o.distance=-o.contentDistance,c(e)}else o.distance-=o.step,c(o.config.speed);else if("down"==o.config.direction||"right"==o.config.direction)if(o.distance>=0){if(o.distance=-o.contentDistance,t(o),!o.config.loop)return e.state.isPause=!0,void(o.onPause&&o.onPause(e.state.isPause));s()}else if(Math.abs(o.distance)<o.step){let e=Math.abs(o.distance)/o.step*o.config.speed;o.distance=0,c(e)}else o.distance+=o.step,c(o.config.speed);function c(e){i(o,e),o.timer&&clearTimeout(o.timer),o.timer=setTimeout((()=>{s()}),e)}}()}function c(t,i){if(function(e){if(!e.el||!e.el instanceof HTMLElement)return console.error('请挂载正确的el元素！例如：document.getElementById("id")'),!1;if(!e.config.modeList.includes(e.config.mode))return console.error("请配置正确的mode滚动方向！例如："+e.config.modeList.join("、")),!1;if(!e.config.directionList.includes(e.config.direction))return console.error("请配置正确的direction滚动方向！例如："+e.config.directionList.join("、")),!1;if(e.config.speed<1||e.config.speed>1e5)return console.error("请配置正确的speed滚动速度！例如：1-100000"),!1;if(e.config.loop&&1!=e.config.loop&&0!=e.config.loop)return console.error("请配置正确的loop是否循环滚动！例如：true、false"),!1;if(e.config.hoverStop&&1!=e.config.hoverStop&&0!=e.config.hoverStop)return console.error("请配置正确的hoverStop是否鼠标移入停止！例如：true、false"),!1;if(e.config.auto&&1!=e.config.auto&&0!=e.config.auto)return console.error("请配置正确的auto是否自动滚动！例如：true、false"),!1;if(e.config.rest){if(!e.config.rest.distance||e.config.rest.distance<1||e.config.rest.distance>1e5)return console.error("请配置正确的rest.distance停留前滚动距离！例如：1-100000"),!1;if(!e.config.rest.time||e.config.rest.time<1||e.config.rest.time>1e5)return console.error("请配置正确的rest.time停留时间！例如：1-100000"),!1}return!0}(i)){if(function(e,t){e.state={isHover:!1,isPause:!1},t.timer=null,t.isHoverShield=!1,t.isStarted=!1,t.contentDistance=0,t.viewDistance=0,t.step=0,t.distance=0,t.onHover=null,t.onPause=null}(t,i),function(e){let t=document.createElement("div");t.style.display="inline-flex","up"!=e.config.direction&&"down"!=e.config.direction||(t.style.flexDirection="column"),t.append(...e.el.children),e.el.append(t),t=null}(i),i.contentDistance=e(i,i.el.firstElementChild),i.viewDistance=e(i,i.el),i.contentDistance<i.viewDistance)return console.warn("滚动元素长度小于滚动视口长度，无需开启滚动！");!function(e){e.viewDistance>600?e.step=15:e.viewDistance>200?e.step=10:e.viewDistance>50?e.step=5:e.step=2}(i),function(t){let i=t.el.firstElementChild.children.length,n=0;for(let o=0;o<i&&(n+=e(t,t.el.firstElementChild.children[o]),t.el.firstElementChild.append(t.el.firstElementChild.children[o].cloneNode(!0)),!(n>=t.viewDistance));o++);}(i),"distance"==i.config.mode&&function(e){let t=e.contentDistance%e.step;if(0!=t){let i=e.step-t;e.contentDistance=e.contentDistance+i;let n=document.createElement("div");n.style.width=i+"px",n.style.height=i+"px",e.el.firstElementChild.append(n),n=null}}(i),i.config.hoverStop&&function(e,t,i){function n(e,t){let i;return function(){const n=this,o=arguments;clearTimeout(i),i=setTimeout((function(){e.apply(n,o)}),t)}}t.el.onmouseover=n((()=>{e.state.isHover||(e.state.isHover=!0,t.isHoverShield||(e.state.isPause=!0,i()))}),100),t.el.onmouseout=n((()=>{e.state.isHover&&(e.state.isHover=!1,t.isHoverShield||(e.state.isPause=!1,i()))}),100)}(t,i,(()=>{"time"==i.config.mode&&s(t,i),i.onHover&&i.onHover(t.state.isHover),i.onPause&&i.onPause(t.state.isPause)})),i.config.auto&&(i.isStarted=!0,"distance"==i.config.mode?o(t,i):"time"==i.config.mode&&s(t,i))}}function r(e,t){t.el.innerHTML=t.raw_el,t.timer&&clearInterval(t.timer),t.config.hoverStop&&t.el.onmouseover&&(t.el.onmouseover=null,t.el.onmouseout=null)}class a{constructor(e){let t={el:e.el,raw_el:e.el.innerHTML,config:{mode:e.mode||"distance",modeList:["distance","time"],direction:e.direction||"up",directionList:["up","down","left","right"],hoverStop:!1!==e.hoverStop,speed:e.speed||100,auto:!1!==e.auto,loop:!1!==e.loop,rest:e.rest||null},timer:null,isHoverShield:!1,isStarted:!1,contentDistance:0,viewDistance:0,step:0,distance:0,onHover:null,onPause:null};this.state={isHover:!1,isPause:!1},this.play=()=>{var e,i;i=t,(e=this).state.isPause=!1,i.onPause&&i.onPause(e.state.isPause),i.isHoverShield=!1,"distance"==i.config.mode?i.isStarted||(i.isStarted=!0,o(e,i)):"time"==i.config.mode&&s(e,i)},this.pause=()=>{var e,i;i=t,(e=this).state.isPause=!0,i.onPause&&i.onPause(e.state.isPause),i.isHoverShield=!0},this.reload=e=>{if(r(0,t),e)for(let i in e)"el"!=i&&(t.config[i]=e[i]);c(this,t)},this.destroy=()=>{r(0,t)},this.getState=()=>this.state,this.on=(e,i)=>{"hover"===e&&(t.onHover=i),"pause"===e&&(t.onPause=i)},this.off=e=>{"hover"===e&&(t.onHover=null),"pause"===e&&(t.onPause=null)},c(this,t)}}export{a as default};
